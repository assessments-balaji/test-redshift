CREATE TABLE CRMMDM.EMAIL_AGGREGATE(
EMAIL_ID	INTEGER 	NOT NULL	
,EMAIL_ADDRESS	VARCHAR(511) NOT NULL,CUST_ID			BIGINT,CUST_KEY			BIGINT,FIRST_NM			VARCHAR(75),MIDDLE_NM			VARCHAR(75),LAST_NM			VARCHAR(75),GENDER			VARCHAR(10),ADDR_LINE_1			VARCHAR(100),ADDR_LINE_2			VARCHAR(100),ADDR_LINE_3			VARCHAR(100),CITY_NM			VARCHAR(75),COUNTY_NM			VARCHAR(75),SRC_ID_FOR_ADDR			VARCHAR(50),STATE			VARCHAR(10),ZIP_CD			VARCHAR(10),COUNTRY			VARCHAR(3),BEST_PHONE_NUM			VARCHAR(26),ORIG_ACQUIRED_BRANDS			VARCHAR(7),AFFILIATED_BRANDS			VARCHAR(7),CURR_SUBSCRIBED_BRANDS			VARCHAR(7),IS_APP_USER			VARCHAR(1),DT_FIRST_PURCH			DATE,FIRST_PURCH_DT_TCP			DATE,FIRST_PURCH_DT_GYM			DATE,LAST_PURCH_DT_TCP			DATE,LAST_PURCH_DT_GYM			DATE,TOT_NBR_PURCH_TCP			INTEGER,TOT_NBR_PURCH_GYM			INTEGER,FIRST_STORE_PURCH_DT_TCP	DATE,FIRST_STORE_PURCH_DT_GYM	DATE,FIRST_ECOM_PURCH_DT_TCP	DATE,FIRST_ECOM_PURCH_DT_GYM	DATE,LAST_STORE_PURCH_DT_TCP	DATE,LAST_STORE_PURCH_DT_GYM	DATE,LAST_ECOM_PURCH_DT_TCP		DATE,LAST_ECOM_PURCH_DT_GYM		DATE,LAST_BOSS_DT_TCP			DATE,LAST_BOSS_DT_GYM			DATE,LAST_BOPIS_DT_TCP			DATE,LAST_BOPIS_DT_GYM			DATE,NBR_BOSS_PURCH_L2Y_TCP		INTEGER,NBR_BOSS_PURCH_L2Y_GYM		INTEGER,NBR_BOPIS_PURCH_L2Y_TCP	INTEGER,NBR_BOPIS_PURCH_L2Y_GYM	INTEGER,CHILD_GENDER_TCP			VARCHAR(5),CHILD_GENDER_GYM 			VARCHAR(5),GIFTER_FLG					VARCHAR(1),LST_PURCH_CATEGORY_TCP		VARCHAR(100),LST_PURCH_CATEGORY_GYM		VARCHAR(100),MISMATCH_BILL_SHIP_TCP		VARCHAR(1),MISMATCH_BILL_SHIP_GYM		VARCHAR(1),LST_EML_ACTIVITY_DT_TCP	DATE,LST_EML_ACTIVITY_DT_GYM	DATE,DAYS_SINCE_PREV_ACT_TCP	INTEGER,PREV_EML_ACTIVITY_DT_TCP	DATE,PREV_EML_ACTIVITY_DT_GYM	DATE,DAYS_SINCE_PREV_ACT_GYM	INTEGER,LAST_EML_CLICK_TMSTMP_TCP	TIMESTAMP,LAST_EML_CLICK_TMSTMP_GYM	TIMESTAMP,LAST_EML_OPEN_TMSTMP_TCP	TIMESTAMP,LAST_EML_OPEN_TMSTMP_GYM	TIMESTAMP,LAST_EML_SEND_TMSTMP_TCP	TIMESTAMP,LAST_EML_SEND_TMSTMP_GYM	TIMESTAMP,NTF_FLG_TCP	VARCHAR(1),NTF_FLG_GYM	VARCHAR(1),NTF_PURCHASER_FLG_TCP			VARCHAR(1),NTF_PURCHASER_FLG_GYM			VARCHAR(1),NTF_NON_PURCHASER_FLG_TCP		VARCHAR(1),NTF_NON_PURCHASER_FLG_GYM		VARCHAR(1),DIVISION_NUMBER			VARCHAR(2),LANGUAGE			VARCHAR(41),COMPLAINT_FLG			VARCHAR(1),EXEC_EMAIL_FLG			VARCHAR(1),EMAIL_CREATE_DT			DATE,EMAIL_FST_SUB_DT_TCP			DATE,EMAIL_FST_SUB_DT_GYM			DATE,EMAIL_LST_SUB_DT_TCP			DATE,EMAIL_LST_SUB_DT_GYM			DATE,EMAIL_OPTIN_DT_TCP			DATE,EMAIL_OPTIN_DT_GYM			DATE,LST_EMAIL_UNSUB_TMSTMP_TCP			TIMESTAMP,LST_EMAIL_UNSUB_TMSTMP_GYM			TIMESTAMP,EMAIL_RESUB_DT_TCP			DATE,EMAIL_RESUB_DT_GYM			DATE,EM_RESUB_TYPE_TCP			VARCHAR(15),EM_RESUB_TYPE_GYM			VARCHAR(15),FIRST_PURCH_DT_POST_RESUB_TCP			DATE,FIRST_PURCH_DT_POST_RESUB_GYM			DATE,LST_EMAIL_HARDBOUNCE_TMSTMP			TIMESTAMP,EMAIL_VALID_IND			VARCHAR(1),EMAIL_ENGAGEMENT_ACT_IND_TCP			VARCHAR(1),EMAIL_ENGAGEMENT_ACT_IND_GYM			VARCHAR(1),COI_FLG_TCP			VARCHAR(1),COI_FLG_GYM			VARCHAR(1),COI_CONFIRMED_IND_TCP			VARCHAR(1),COI_CONFIRMED_IND_GYM			VARCHAR(1),COI_START_DT_TCP			DATE,COI_START_DT_GYM			DATE,COI_CHANGE_DT_TCP			DATE,COI_CHANGE_DT_GYM			DATE,EM_PRCH_FORMAT_TCP			VARCHAR(2),EM_PRCH_FORMAT_GYM			VARCHAR(2),EMAIL_FORMAT_TYPE_IND_TCP			VARCHAR(20),EMAIL_FORMAT_TYPE_IND_GYM			VARCHAR(20),AGEOFF_NUMERIC_TCP			VARCHAR(15),AGEOFF_NUMERIC_GYM			VARCHAR(15),EMAIL_FORMAT_TYPE_TCP			VARCHAR(20),EMAIL_FORMAT_TYPE_GYM			VARCHAR(20),EM_FMT_SHIFT_DT_TCP			DATE,EM_FMT_SHIFT_DT_GYM			DATE,AGEOFF_START_DT_TCP			DATE,AGEOFF_START_DT_GYM			DATE,EM_FMT_PURCH_FLG_TCP			VARCHAR(2),EM_FMT_PURCH_FLG_GYM			VARCHAR(2),EM_FMT_RESPONSE_CNT_TCP	INTEGER,EM_FMT_RESPONSE_CNT_GYM	INTEGER,EM_TRIGGER_START_DT_TCP	DATE,EM_TRIGGER_START_DT_GYM	DATE,LIFECYCLE			VARCHAR(13),LIFECYCLE_TCP			VARCHAR(13),LIFECYCLE_GYM			VARCHAR(13),LIFESTAGE			VARCHAR(23),LST_ENROLL_BDAY_TMSTMP	 TIMESTAMP,CUST_BIRTHDAY			DATE,CHILD1_NAME			VARCHAR(32),CHILD1_BIRTH_YYYYMM	VARCHAR(7)	,CHILD2_NAME			VARCHAR(32),CHILD2_BIRTH_YYYYMM	VARCHAR(7)		,CHILD3_NAME			VARCHAR(32),CHILD3_BIRTH__YYYYMM	VARCHAR(7)		,CHILD4_NAME			VARCHAR(32),CHILD4_BIRTH_YYYYMM	VARCHAR(7)		,AGED_OUT_FLG			VARCHAR(1),PLCC_IND			VARCHAR(1),LST_ENROLL_PLCC_TMSTMP			TIMESTAMP,PLCC_ACCT_KEY			VARCHAR(255),PLCC_CREATE_DT			DATE,CARD_ISSUE_DATE			DATE,PLCC_OPEN_DT			DATE,LST_ENROLL_MYPLCE_TMSTMP			TIMESTAMP,MPR_IND			VARCHAR(1),MPR_ACCT_KEY			VARCHAR(255),MYPLACE_ACCT_NBR			VARCHAR(30),MPR_PLCC_IND			VARCHAR(1),FAVORITE_STORE_ID			VARCHAR(12),NEAREST_STORE_ID			VARCHAR(12),NEAREST_STORE_DISTANCE			INTEGER,ENROLLMENT_STORE_ID			VARCHAR(12),PREFERRED_STORE_ID			VARCHAR(12),PREFERRED_STORE_DISTANCE			INTEGER,WCS_USER_ID			INTEGER,SHOPPER_TYPE			VARCHAR(50),CURRENT_PT_BALANCE_CNT			INTEGER,PTS_TO_NEXT_REWARD			INTEGER,PTS_EXPIRY_THIS_MONTH			INTEGER,PTS_EXPIRY_MONTH			INTEGER)

CREATE VIEW CRMUNICA.EMAIL_AGGREGATE_VW as select * from CRMMDM.EMAIL_AGGREGATE;